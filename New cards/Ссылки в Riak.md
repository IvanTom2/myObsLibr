Ссылками в Riak называются метаданные, ассоциирующие один ключ с другими. Базовая структура ключа имеет следующий вид:
`Link: </riak/bucket/key>; riaktag=\"whatever"`

Ключ, на который указывает эта ссылка, заключен в угловые скобки. Тег описывает как ссылка соотносится с данным значением (произвольная строка). 

Ссылка всегда создается однонаправленная, иными словами ссылка будет существовать только в рамках того объекта, в котором она была указана. То есть объект, на который указывает ссылка, не будет никак изменен и не будет явно содержать новую информацию. 

Каждый объект может хранить неограниченное количество ссылок. 

В Riak существует механизм следования по ссылкам. Для получения связанных данных необходимо добавить в URL объекта спецификацию ссылки, устроенную следующим образом: `/_,_,_`. Знаки подчеркивания представляют собой метасимволы для каждого из параметров ссылки: сегмент, тег и признак (`keep`). 

Вызвать связанные ссылки можно через команду: `curl http://localhost:8098/riak/cages/1/_,_,_`. Тем не менее, при таком вызове будет возвращаться ***данные MIME-типа*** `multipart/mixed`, в который входят заголовки и тела, включающие все связанные ключи и значения и смотреть на это не очень приятно. 

Данные MIME-типа `multipart/mixed` разграничены разделителем, который записан в заголовке `boundary`. Ниже значение этого заголовка равно `9icDLhUDbI0c0KUbIOTAMkyLLV3`,  соответственно, между двумя такими значениями будет находиться заголовок и тело одной записи из БД. 

Следование по ссылкам можно специфицировать. Это делается с помощью изменения прочерков `_` в URL. Заместо первого прочерка можно поставить сегмента (например, `animals`) - тогда вернутся записи только из указанного сегмента, если на такие вообще указывают ссылки. Либо можно специфицировать следование по тегу, который имеют ссылки, например, `next_to`. 

В Riak следование ссылок может быть вложенным. Третий параметр ссылки это признак `keel` и он нужен, чтобы специфицировать вывода данных в промежуточном следовании ссылкам. Так, например, можно вызывать следующее следование ссылкам `curl http://localhost:8091/riak/cages/2/_,next_to,0/animals,_,_`. Здесь сначала будут найдены клетки `next_to` (которые рядом с текущей), а затем вызвано следование по этим клетками со спецификацией по сегменту `animals`. Спецификация `keep=0` в первом вызове следования по ссылкам говорит о том, что не нужно возвращать данные при это следовании. Вообще, по дефолту при наличии вложенных ссылок пустое значение `_` интерпретируется как 0 для параметра `keep`. 

___
```
curl -X PUT http://localhost:8091/riak/cages/1 \ 
-H "Content-Type: application/json" \
-H "Link: </riak/animals/polly>; riaktag=\"contains\"" \
-d '{"room" : 101}'

curl -X PUT http://localhost:8098/riak/cages/2 -H "Content-Type: application/json" -H "Link:</riak/animals/ace>;riaktag=\"contains\", </riak/cages/1>;riaktag=\"next_to\"" -d '{"room" : 101}'

curl http://localhost:8098/riak/cages/1/_,_,_
>> return of this call:

--RGZK1lp4tdD4NooaYjGgUtFzLty
Content-Type: multipart/mixed; boundary=9icDLhUDbI0c0KUbIOTAMkyLLV3

--9icDLhUDbI0c0KUbIOTAMkyLLV3
...
--9icDLhUDbI0c0KUbIOTAMkyLLV3


curl http://localhost:8098/riak/cages/1/animals,_,_
curl http://localhost:8098/riak/cages/1/_,next_to,_
curl http://localhost:8098/riak/cages/1/_,_,1

```
___
Зачем это нужно: [[]] 
Примеры применения: [[]] 
Основные ошибки: [[]]
___
Relations: [[Riak]] 
Tags: #code
References: [[Семь баз данных]] 
Query: 